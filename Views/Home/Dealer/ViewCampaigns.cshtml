@model ViewCampaignsViewModel
@{
    ViewData["Title"] = "Campaigns";
}

<link rel="stylesheet" href="~/css/DealerDashboard.css" />

<div class="container-fluid">
    

    <div class="card">
        <div class="card-header">
            <h5><i class="fas fa-bullhorn"></i> Campaigns</h5>
        </div>
        <div class="card-body">
            <!-- Points to Cash Campaigns -->
            <div class="mb-3"> <!-- Reduced margin -->
                <h2 class="section-header">
                    <i class="fas fa-money-bill-wave text-green-600"></i>
                    Points to Cash Campaigns
                </h2>
                @if (Model.DetailedPointsToCashCampaigns.Any())
                {
                    <div class="grid">
                        @foreach (var campaign in Model.DetailedPointsToCashCampaigns)
                        {
                            <div class="campaign-card">
                                <div class="campaign-title">@campaign.CampaignName</div>
                                <div class="campaign-details">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Status</div>
                                        <div class="detail-value">
                                            @if (campaign.IsActive)
                                            {
                                                <span class="campaign-status active">Active</span>
                                            }
                                            else
                                            {
                                                <span class="campaign-status inactive">Inactive</span>
                                            }
                                        </div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Start Date</div>
                                        <div class="detail-value">@campaign.StartDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">End Date</div>
                                        <div class="detail-value">@campaign.EndDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                </div>
                                
                                @if (!string.IsNullOrEmpty(campaign.ImagePath))
                                {
                                    <div class="campaign-image">
                                        <img src="@campaign.ImagePath" alt="@campaign.CampaignName" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/000000?text=No+Image+Available';" />
                                    </div>
                                }
                                else
                                {
                                    <div class="campaign-image">
                                        <div class="bg-gray-100 flex items-center justify-center h-full">
                                            <i class="fas fa-image text-gray-400 text-2xl"></i>
                                        </div>
                                    </div>
                                }
                                
                                <button type="button" class="toggle-details-btn" onclick="toggleDetails('pointsToCash-@campaign.Id')">
                                    Show Details
                                </button>
                                
                                <div id="pointsToCash-@campaign.Id" class="campaign-details-content" style="display: none;">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Threshold</div>
                                        <div class="detail-value">@campaign.VoucherGenerationThreshold points</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Voucher Value</div>
                                        <div class="detail-value">₹@campaign.VoucherValue</div>
                                    </div>
                                    
                                    @if (campaign.MaterialDetails.Any())
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Materials (@campaign.MaterialDetails.Count)</div>
                                            @foreach (var material in campaign.MaterialDetails)
                                            {
                                                <div class="d-flex justify-content-between mt-1">
                                                    <span>@material.MaterialName</span>
                                                    <span>@material.Points points</span>
                                                </div>
                                            }
                                        </div>
                                    }
                                    
                                    @if (!string.IsNullOrEmpty(campaign.Description))
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Description</div>
                                            <div class="detail-value">@campaign.Description</div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-campaigns">
                        <i class="fas fa-money-bill-wave"></i>
                        <h4>No Points to Cash Campaigns</h4>
                        <p>There are no Points to Cash campaigns available at the moment.</p>
                    </div>
                }
            </div>

            <!-- Points Reward Campaigns -->
            <div class="mb-3"> <!-- Reduced margin -->
                <h2 class="section-header">
                    <i class="fas fa-gift text-blue-600"></i>
                    Points Reward Campaigns
                </h2>
                @if (Model.DetailedPointsRewardCampaigns.Any())
                {
                    <div class="grid">
                        @foreach (var campaign in Model.DetailedPointsRewardCampaigns)
                        {
                            <div class="campaign-card">
                                <div class="campaign-title">@campaign.CampaignName</div>
                                <div class="campaign-details">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Status</div>
                                        <div class="detail-value">
                                            @if (campaign.IsActive)
                                            {
                                                <span class="campaign-status active">Active</span>
                                            }
                                            else
                                            {
                                                <span class="campaign-status inactive">Inactive</span>
                                            }
                                        </div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Start Date</div>
                                        <div class="detail-value">@campaign.StartDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">End Date</div>
                                        <div class="detail-value">@campaign.EndDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                </div>
                                
                                @if (!string.IsNullOrEmpty(campaign.ImagePath))
                                {
                                    <div class="campaign-image">
                                        <img src="@campaign.ImagePath" alt="@campaign.CampaignName" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/000000?text=No+Image+Available';" />
                                    </div>
                                }
                                else
                                {
                                    <div class="campaign-image">
                                        <div class="bg-gray-100 flex items-center justify-center h-full">
                                            <i class="fas fa-image text-gray-400 text-2xl"></i>
                                        </div>
                                    </div>
                                }
                                
                                <button type="button" class="toggle-details-btn" onclick="toggleDetails('pointsReward-@campaign.Id')">
                                    Show Details
                                </button>
                                
                                <div id="pointsReward-@campaign.Id" class="campaign-details-content" style="display: none;">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Threshold</div>
                                        <div class="detail-value">@campaign.VoucherGenerationThreshold points</div>
                                    </div>
                                    
                                    @if (campaign.MaterialDetails.Any())
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Materials (@campaign.MaterialDetails.Count)</div>
                                            @foreach (var material in campaign.MaterialDetails)
                                            {
                                                <div class="d-flex justify-content-between mt-1">
                                                    <span>@material.MaterialName</span>
                                                    <span>@material.Points points</span>
                                                </div>
                                            }
                                        </div>
                                    }
                                    
                                    @if (campaign.RewardProduct != null)
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Reward Product</div>
                                            <div class="detail-value">@campaign.RewardProduct.ProductName</div>
                                        </div>
                                    }
                                    
                                    @if (!string.IsNullOrEmpty(campaign.Description))
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Description</div>
                                            <div class="detail-value">@campaign.Description</div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-campaigns">
                        <i class="fas fa-gift"></i>
                        <h4>No Points Reward Campaigns</h4>
                        <p>There are no Points Reward campaigns available at the moment.</p>
                    </div>
                }
            </div>

            <!-- Free Product Campaigns -->
            <div class="mb-3"> <!-- Reduced margin -->
                <h2 class="section-header">
                    <i class="fas fa-box-open text-purple-600"></i>
                    Free Product Campaigns
                </h2>
                @if (Model.DetailedFreeProductCampaigns.Any())
                {
                    <div class="grid">
                        @foreach (var campaign in Model.DetailedFreeProductCampaigns)
                        {
                            <div class="campaign-card">
                                <div class="campaign-title">@campaign.CampaignName</div>
                                <div class="campaign-details">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Status</div>
                                        <div class="detail-value">
                                            @if (campaign.IsActive)
                                            {
                                                <span class="campaign-status active">Active</span>
                                            }
                                            else
                                            {
                                                <span class="campaign-status inactive">Inactive</span>
                                            }
                                        </div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Start Date</div>
                                        <div class="detail-value">@campaign.StartDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">End Date</div>
                                        <div class="detail-value">@campaign.EndDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Items</div>
                                        <div class="detail-value">@campaign.MaterialDetails.Count</div>
                                    </div>
                                </div>
                                
                                @if (!string.IsNullOrEmpty(campaign.ImagePath))
                                {
                                    <div class="campaign-image">
                                        <img src="@campaign.ImagePath" alt="@campaign.CampaignName" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/000000?text=No+Image+Available';" />
                                    </div>
                                }
                                else
                                {
                                    <div class="campaign-image">
                                        <div class="bg-gray-100 flex items-center justify-center h-full">
                                            <i class="fas fa-image text-gray-400 text-2xl"></i>
                                        </div>
                                    </div>
                                }
                                
                                <button type="button" class="toggle-details-btn" onclick="toggleDetails('freeProduct-@campaign.Id')">
                                    Show Details
                                </button>
                                
                                <div id="freeProduct-@campaign.Id" class="campaign-details-content" style="display: none;">
                                    @if (campaign.MaterialDetails.Any())
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Materials (@campaign.MaterialDetails.Count)</div>
                                            @foreach (var material in campaign.MaterialDetails)
                                            {
                                                <div class="d-flex justify-content-between mt-1">
                                                    <span>@material.MaterialName</span>
                                                    <span>@($"{material.Quantity} pcs")</span>
                                                </div>
                                            }
                                        </div>
                                    }
                                    
                                    @if (campaign.FreeProductDetails.Any())
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Free Products (@campaign.FreeProductDetails.Count)</div>
                                            @foreach (var kvp in campaign.FreeProductDetails)
                                            {
                                                var materialId = kvp.Key;
                                                var freeProductDetail = kvp.Value;
                                                <div class="mt-1"> <!-- Reduced margin -->
                                                    <div class="d-flex justify-content-between">
                                                        <span>@freeProductDetail.FreeProductName</span>
                                                        <span>@($"{freeProductDetail.FreeQuantity} pcs")</span>
                                                    </div>
                                                    @{
                                                        var associatedMaterial = campaign.MaterialDetails.FirstOrDefault(m => m.MaterialId == materialId);
                                                        if (associatedMaterial != null)
                                                        {
                                                            <div class="text-muted small">
                                                                For material: @associatedMaterial.MaterialName (Qty: @associatedMaterial.Quantity)
                                                            </div>
                                                        }
                                                    }
                                                </div>
                                            }
                                        </div>
                                    }
                                    
                                    @if (!string.IsNullOrEmpty(campaign.Description))
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Description</div>
                                            <div class="detail-value">@campaign.Description</div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-campaigns">
                        <i class="fas fa-box-open"></i>
                        <h4>No Free Product Campaigns</h4>
                        <p>There are no Free Product campaigns available at the moment.</p>
                    </div>
                }
            </div>

            <!-- Amount Reach Goal Campaigns -->
            <div class="mb-3"> <!-- Reduced margin -->
                <h2 class="section-header">
                    <i class="fas fa-chart-line text-yellow-600"></i>
                    Amount Reach Goal Campaigns
                </h2>
                @if (Model.AmountReachGoalCampaigns.Any())
                {
                    <div class="grid">
                        @foreach (var campaign in Model.AmountReachGoalCampaigns)
                        {
                            <div class="campaign-card">
                                <div class="campaign-title">@campaign.CampaignName</div>
                                <div class="campaign-details">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Status</div>
                                        <div class="detail-value">
                                            @if (campaign.IsActive)
                                            {
                                                <span class="campaign-status active">Active</span>
                                            }
                                            else
                                            {
                                                <span class="campaign-status inactive">Inactive</span>
                                            }
                                        </div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Start Date</div>
                                        <div class="detail-value">@campaign.StartDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">End Date</div>
                                        <div class="detail-value">@campaign.EndDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                </div>
                                
                                @if (!string.IsNullOrEmpty(campaign.ImagePath))
                                {
                                    <div class="campaign-image">
                                        <img src="@campaign.ImagePath" alt="@campaign.CampaignName" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/000000?text=No+Image+Available';" />
                                    </div>
                                }
                                else
                                {
                                    <div class="campaign-image">
                                        <div class="bg-gray-100 flex items-center justify-center h-full">
                                            <i class="fas fa-image text-gray-400 text-2xl"></i>
                                        </div>
                                    </div>
                                }
                                
                                <button type="button" class="toggle-details-btn" onclick="toggleDetails('amountReach-@campaign.Id')">
                                    Show Details
                                </button>
                                
                                <div id="amountReach-@campaign.Id" class="campaign-details-content" style="display: none;">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Target</div>
                                        <div class="detail-value">₹@campaign.TargetAmount</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Voucher Value</div>
                                        <div class="detail-value">₹@campaign.VoucherValue</div>
                                    </div>
                                    
                                    @if (!string.IsNullOrEmpty(campaign.Description))
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Description</div>
                                            <div class="detail-value">@campaign.Description</div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-campaigns">
                        <i class="fas fa-chart-line"></i>
                        <h4>No Amount Reach Goal Campaigns</h4>
                        <p>There are no Amount Reach Goal campaigns available at the moment.</p>
                    </div>
                }
            </div>

            <!-- Session Duration Reward Campaigns -->
            <div>
                <h2 class="section-header">
                    <i class="fas fa-clock text-red-600"></i>
                    Session Duration Reward Campaigns
                </h2>
                @if (Model.SessionDurationRewardCampaigns.Any())
                {
                    <div class="grid">
                        @foreach (var campaign in Model.SessionDurationRewardCampaigns)
                        {
                            <div class="campaign-card">
                                <div class="campaign-title">@campaign.CampaignName</div>
                                <div class="campaign-details">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Status</div>
                                        <div class="detail-value">
                                            @if (campaign.IsActive)
                                            {
                                                <span class="campaign-status active">Active</span>
                                            }
                                            else
                                            {
                                                <span class="campaign-status inactive">Inactive</span>
                                            }
                                        </div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Start Date</div>
                                        <div class="detail-value">@campaign.StartDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">End Date</div>
                                        <div class="detail-value">@campaign.EndDate.ToString("dd/MM/yyyy")</div>
                                    </div>
                                </div>
                                
                                @if (!string.IsNullOrEmpty(campaign.ImagePath))
                                {
                                    <div class="campaign-image">
                                        <img src="@campaign.ImagePath" alt="@campaign.CampaignName" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/000000?text=No+Image+Available';" />
                                    </div>
                                }
                                else
                                {
                                    <div class="campaign-image">
                                        <div class="bg-gray-100 flex items-center justify-center h-full">
                                            <i class="fas fa-image text-gray-400 text-2xl"></i>
                                        </div>
                                    </div>
                                }
                                
                                <button type="button" class="toggle-details-btn" onclick="toggleDetails('sessionDuration-@campaign.Id')">
                                    Show Details
                                </button>
                                
                                <div id="sessionDuration-@campaign.Id" class="campaign-details-content" style="display: none;">
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Duration</div>
                                        <div class="detail-value">@campaign.SessionDuration minutes</div>
                                    </div>
                                    <div class="campaign-detail-item">
                                        <div class="detail-label">Voucher Value</div>
                                        <div class="detail-value">₹@campaign.VoucherValue</div>
                                    </div>
                                    
                                    @if (!string.IsNullOrEmpty(campaign.Description))
                                    {
                                        <div class="mt-2"> <!-- Reduced margin -->
                                            <div class="detail-label">Description</div>
                                            <div class="detail-value">@campaign.Description</div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                }
                else
                {
                    <div class="empty-campaigns">
                        <i class="fas fa-clock"></i>
                        <h4>No Session Duration Reward Campaigns</h4>
                        <p>There are no Session Duration Reward campaigns available at the moment.</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<script>
    function toggleDetails(id) {
        var detailsDiv = document.getElementById(id);
        if (!detailsDiv) return;
        var isHidden = detailsDiv.style.display === 'none';
        if (isHidden) {
            detailsDiv.style.display = 'block';
        } else {
            detailsDiv.style.display = 'none';
        }
    }
</script>